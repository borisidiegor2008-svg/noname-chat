<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RED_VOID // ANONYMOUS_LOG</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // –¢–í–û–ò –î–ê–ù–ù–´–ï –ò–ó –°–ö–†–ò–ù–®–û–¢–ê –£–ñ–ï –ó–î–ï–°–¨
        const firebaseConfig = {
            apiKey: "AIzaSyAWX6aQ1SKn62r4pNChEVgDcXiv27sm_Qs",
            authDomain: "sector-c5e22.firebaseapp.com",
            databaseURL: "https://sector-c5e22-default-rtdb.firebaseio.com",
            projectId: "sector-c5e22",
            storageBucket: "sector-c5e22.firebasestorage.app",
            messagingSenderId: "26133592596",
            appId: "1:26133592596:web:50c3744d2b6f2d8deac501",
            measurementId: "G-GH9J0P00M8"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const msgRef = collection(db, "chat_global");

        const MY_ID = 'ANON-' + Math.random().toString(36).substr(2, 5).toUpperCase();
        document.getElementById('anon-id').innerText = MY_ID;

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏
        window.sendMsg = async () => {
            const input = document.getElementById('msg-input');
            const text = input.value.trim();
            if (!text) return;

            try {
                await addDoc(msgRef, {
                    sender: MY_ID,
                    text: text,
                    time: serverTimestamp()
                });
                input.value = '';
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ", e);
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        const q = query(msgRef, orderBy("time", "asc"));
        onSnapshot(q, (snapshot) => {
            const chat = document.getElementById('chat');
            chat.innerHTML = '';
            snapshot.forEach(doc => {
                const data = doc.data();
                const isMine = data.sender === MY_ID;
                const div = document.createElement('div');
                div.className = `msg ${isMine ? 'mine' : ''}`;
                div.innerHTML = `
                    <div class="meta">${data.sender} // ${data.time ? data.time.toDate().toLocaleTimeString() : '...'}</div>
                    <div class="txt">${data.text}</div>
                `;
                chat.appendChild(div);
            });
            chat.scrollTop = chat.scrollHeight;
        });
    </script>

    <style>
        :root { --red: #ff0000; --dark: #0a0000; }
        * { box-sizing: border-box; }
        body { background: var(--dark); color: var(--red); font-family: 'Courier New', monospace; margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        #matrix { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.15; }
        
        header { padding: 15px; background: #1a0000; border-bottom: 2px solid var(--red); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 0 10px var(--red); }
        
        #chat { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        
        .msg { background: rgba(40, 0, 0, 0.6); padding: 12px; border-left: 3px solid var(--red); max-width: 85%; animation: slide 0.2s ease-out; }
        .msg.mine { align-self: flex-end; border-left: none; border-right: 3px solid #fff; color: #fff; background: rgba(60, 0, 0, 0.8); }
        
        .meta { font-size: 0.7rem; color: #ff6666; margin-bottom: 5px; font-weight: bold; }
        .msg.mine .meta { color: #aaa; }

        .input-area { padding: 15px; background: #110000; border-top: 2px solid var(--red); display: flex; gap: 10px; }
        input { flex: 1; background: #000; border: 1px solid var(--red); color: var(--red); padding: 12px; outline: none; }
        button { background: var(--red); color: #000; border: none; padding: 0 25px; font-weight: bold; cursor: pointer; text-transform: uppercase; }

        @keyframes slide { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        
        /* –ú–æ–± –≤–µ—Ä—Å–∏—è */
        @media (max-width: 600px) {
            header h1 { font-size: 1.1rem; }
            .msg { max-width: 100%; }
        }
    </style>
</head>
<body>

<canvas id="matrix"></canvas>

<header>
    <h1>üî¥ RED_VOID_v1</h1>
    <div style="font-size: 0.8rem;">üï∂Ô∏è <span id="anon-id">...</span></div>
</header>

<div id="chat"></div>

<div class="input-area">
    <input type="text" id="msg-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ..." onkeypress="if(event.key==='Enter') sendMsg()">
    <button onclick="sendMsg()">SEND</button>
</div>

<script>
    const c = document.getElementById('matrix');
    const ctx = c.getContext('2d');
    c.width = window.innerWidth; c.height = window.innerHeight;
    const drops = Array(Math.floor(c.width/16)).fill(1);
    function draw() {
        ctx.fillStyle = "rgba(0,0,0,0.05)"; ctx.fillRect(0,0,c.width,c.height);
        ctx.fillStyle = "#f00"; ctx.font = "16px monospace";
        drops.forEach((y, i) => {
            ctx.fillText(Math.random() > 0.5 ? "0" : "1", i*16, y*16);
            if(y*16 > c.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        });
    }
    setInterval(draw, 50);
</script>

</body>
</html>
